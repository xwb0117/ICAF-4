# ICAF-4: An Integrated Framework of Category-level Articulated Object Perception and Manipulation for Embodied Intelligence
This repository is the official implementation of the paper [ICAF-4: An Integrated Framework of Category-level Articulated Object Perception and Manipulation for Embodied Intelligence](https://w.afbcs.cn/V5uaBm). This paper has been accepted to BMVC 2024.

![imag](https://github.com/xwb0117/ICAF-4/blob/main/icaf-4.png))

## Installation
This code has been tested on Ubuntu 20.04 with Python 3.7, CUDA 11.3 and Pytorch 1.10.0 Firstly, create environment and install the dependencies:

```bash
conda create -n ICAF-4 python=3.7
conda activate ICAF-4
pip install -r requirements.txt
```
And build the CUDA kernels for PointNet++
```bash
git clone --recursive https://github.com/erikwijmans/Pointnet2_PyTorch
cd Pointnet2_PyTorch
pip install -r requirements.txt
pip install -e 
```

## Datasets
Download our generated dataset from ArtImage at [BaiduYun(code:2e3q)](https://pan.baidu.com/s/1mocuF02vKf7_YWFKaclgxw?pwd) and [OneDrive](https://onedrive.live.com/?cid=0CEC31BD19A86C5F&id=CEC31BD19A86C5F%21s618290dc5a61431fa6b3ced1732bde45&parId=root&o=OneUp), and save in ```/data```

## Training

Take Laptop as example:

```bash
python train.py --model ICAFNet  --category laptop --num_part 2 --L 60 --log_dir ICAF_laptop
```

If you want to save the prediction results, you can use this:

```bash
python train.py --model ICAFNet  --category laptop --num_part 2 --L 60 --log_dir ICAF_laptop --save_results True
```

## Optimization

Here is used to optimize pose estimation:

```bash
python optimize.py --category laptop --num_part 2 --process_num 64 --dataset ArtImage
```

## Evaluation

If you want to perform validation, you can use this:

```bash
python evaluate.py --category laptop --num_part 2 --dataset ArtImage
```

## Data Generation
The grasping data can be generated by modifying the [where2act](https://github.com/daerduoCarey/where2act) project.
